<?xml version="1.0" encoding="utf-8"?>
<detail:EntityFormItem xmlns:fx="http://ns.adobe.com/mxml/2009"
					   xmlns:s="library://ns.adobe.com/flex/spark"
					   xmlns:mx="library://ns.adobe.com/flex/mx"
					   xmlns:datagroup="org.openforis.collect.ui.component.datagroup.*"
					   xmlns:detail="org.openforis.collect.ui.component.detail.*"
					   >
	
	<detail:layout>
		<s:VerticalLayout paddingTop="15" />
	</detail:layout>
	
	<fx:Script>
		<![CDATA[
			import mx.events.FlexEvent;
			
			import org.openforis.collect.metamodel.proxy.ModelVersionProxy;
			import org.openforis.collect.Application;
			import org.openforis.collect.metamodel.proxy.EntityDefinitionProxy;
			import org.openforis.collect.model.proxy.EntityProxy;
			import org.openforis.collect.presenter.MultipleEntityFormItemPresenter;
			import org.openforis.collect.ui.Images;
			import org.openforis.collect.ui.UIBuilder;
			
			import spark.components.HGroup;
			
			override protected function initPresenter():void {
				presenter = new MultipleEntityFormItemPresenter(this);
			}
			
			override protected function createChildren():void {
				if(!childrenAdded) {
					super.createChildren();
					
					var headers:HGroup = UIBuilder.buildDataGroupHeaders(this.entityDefinition, modelVersion);					
					headers.paddingLeft = 30;
					
					addElement(headerLabel);
					addElement(headers);
					addElement(dataGroup);
					
					if ( !entityDefinition.enumerated) {
						addElement(addButton);
					}

					super.childrenAdded = true;
				}
			}
			
		]]>
			
	</fx:Script>
	
	<fx:Declarations>
		
		<s:Label id="headerLabel" text="{entityDefinition.getLabelText()}" styleName="bold" />
		
		<s:DataGroup width="100%" id="dataGroup">
			<s:layout>
				<s:VerticalLayout gap="2" paddingLeft="30" />
			</s:layout> 
			<s:itemRenderer>
				<fx:Component>
					<detail:EntityDataGroupItemRenderer
						entity="{data as EntityProxy}"
						modelVersion="{outerDocument.modelVersion}"
						nodeDefinitions="{outerDocument.nodeDefinitions}"
						/>
				</fx:Component>
			</s:itemRenderer>
		</s:DataGroup>
		
		<mx:LinkButton
					id="addButton"
					label="Add" 
					buttonMode="true" 
					icon="{Images.ADD}" 
					labelPlacement="left" 
					useHandCursor="true"
					paddingLeft="30"
					/>
	</fx:Declarations>
	
</detail:EntityFormItem>
